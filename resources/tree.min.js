function TreeDemo(){function r(e,t){const n=8;this.x=e,this.y=t,this.draw=function(){o.fillRect(this.x-n/2,this.y-n/2,n,n),o.fill()},this.add=function(e){return new r(this.x+e.x,this.y+e.y)},this.subtract=function(e){return new r(this.x-e.x,this.y-e.y)}}function i(){this.points=[],this.addPoint=function(e){this.points.push(e)},this.draw=function(){for(var e=0;e!=this.points.length;++e)this.points[e].draw()}}function u(e,t,n,r){this.centre=e,this.radius=t,this.alpha=n,this.intensity=r}function c(e,t,n,r){a[l]=new u(e,t,n,r),l++}function h(){if(f==l)return;var e=a[f];f++,p(e.centre,e.radius,e.alpha,e.intensity),setTimeout(h,100)}function p(e,t,n,r){const i=10,s=Math.PI*2/i;var u=o.strokeStyle,a=o.lineWidth;o.fillStyle="rgba(40, "+parseInt(120+r*40)+", 20, "+n+")",o.lineWidth=1,o.beginPath(),o.moveTo(e.x+t,e.y);for(var f=1;f!=i;++f){var l=s*f;o.lineTo(e.x+t*Math.cos(l),e.y+t*Math.sin(l))}o.lineTo(e.x+t,e.y),o.fill(),o.strokeStyle=u,o.lineWidth=a}function d(e,t,n){const i=10,s=5,u=Math.PI/3,a=20;var f=t+1,l=e[f],p=n.x-l.x,v=n.y-l.y,m=Math.sqrt(p*p+v*v);m<a&&(f++,t++,l=e[f]);if(f==e.length){c(n,5+Math.random()*10,.4+Math.random()*.3,.4*Math.random()),h();return}var g=l.subtract(n),y=Math.atan2(g.y,g.x),b=y+u*Math.random()-u/2,w=i+s*Math.random()-s,E=new r(w*Math.cos(b),w*Math.sin(b)),S=E.add(n),x=parseInt(50*(t/e.length));o.lineWidth=3,o.strokeStyle="rgba(120, "+(80+x)+", 50, 0.4)",o.beginPath(),o.moveTo(n.x,n.y),o.lineTo(S.x,S.y),o.stroke(),t>4&&Math.random()<.25&&c(n,5+Math.random()*10,.1+Math.random()*.5,.2),setTimeout(d,50,e,t,S)}function y(e,t,n,s){this.point=e,this.cluster=i.createRandomized(this.point,v,(s+1)*4),this.next=[];if(s>0){var o=m*n,u=t+g,a=t-g;this.next[0]=new y(r.createRadial(o,u).add(this.point),u,o,s-1),this.next[1]=new y(r.createRadial(o,a).add(this.point),a,o,s-1)}this.draw=function(){this.cluster.draw();for(var e=0;e!=this.next.length;++e)this.next[e].draw()},this.passThrough=function(e,t){if(s==0)return[this.cluster.points[t]];var n=Math.floor(this.next.length*Math.random()),r=this.next[n],i=r.passThrough(this.cluster,t),o=[e.points[t]];return o.concat(i)}}function b(e,t){const n=20,i=8;var s=t.x-e.x,o=t.y-e.y,u=Math.sqrt(s*s+o*o),a=Math.floor(u/n),f=[];for(var l=0;l!=a;++l){var c=l*s/a,h=l*o/a,p=Math.random()*i-i,d=Math.random()*i-i;f[l]=new r(e.x+c+p,e.y+h+d)}return f}const e=300,t=200,n=new r(e/2,t/2);r.createRadial=function(e,t){return new r(e*Math.cos(t),e*Math.sin(t))},i.createRandomized=function(e,t,n){var s=e.x+n/2,o=e.x-n/2,u=e.y+n/2,a=e.y-n/2,f=new i;for(var l=0;l!=t;++l){var c=o+n*Math.random(),h=a+n*Math.random();f.addPoint(new r(c,h))}return f},i.createRandomizedHorizontal=function(e,t,n){var s=e.x+n/2,o=e.x-n/2,u=new i;for(var a=0;a!=t;++a){var f=o+n*Math.random(),l=n*Math.random()-n/2+e.y;console.debug(l),u.addPoint(new r(f,l))}return u};var s=document.getElementById("screen"),o=s.getContext("2d");o.clearRect(0,0,e,t);var a=[],f=0,l=0;const v=200;this.start_tree=function(){var e=i.createRandomizedHorizontal(new r(n.x,140),v,50),t=new y(new r(n.x,130),-Math.PI/2,30,6),s=[];for(var o=0;o!=v;++o)s[o]=t.passThrough(e,o);for(var o=0;o!=s.length;++o)d(s[o],0,s[o][0])};const m=.9,g=Math.PI/6};